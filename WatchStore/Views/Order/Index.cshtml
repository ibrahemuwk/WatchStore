@model IEnumerable<WatchStore.Models.Products>
<!-- Title Page -->
<section class="bg-title-page p-t-40 p-b-50 flex-col-c-m" style="background-image: url(/Content/DesignContent/images/master-slide-02.jpg);;background-position:center;">
    <h2 class="l-text2 t-center">
        Cart
    </h2>
</section>

<!-- Cart -->

<section class="cart bgwhite p-t-70 p-b-100">
    <div class="container">

        @if (Model.Count() > 0)
        {<!-- Cart item -->
            /**/
            <div class="container-table-cart pos-relative">
                <div class="wrap-table-shopping-cart bgwhite">
                    <table class="table-shopping-cart">
                        <tr class="table-head " >
                            <th style="text-align: center;" class="column-1"></th>
                            <th style="text-align: center;" class="column-2">Product</th>
                            <th style="text-align: center;" class="column-3">Price</th>
                            
                        </tr>
                        @{ double total = 0;}
                        @foreach (var item in Model)
                        {
                        <tr class="table-row text-center">
                            <td class="column-1">
                                <div class="cart-img-product b-rad-4 o-f-hidden">
                                    <img src="@Url.Action("UserPhotos", "Home", new {id = item.ProductId})" alt="IMG-PRODUCT">
                                </div>
                            </td>
                            <td class="column-2">@item.ProductName</td>
                            <td class="column-3">
                                @if (item.ProductSale > 0)
                                {
                                    <span class="block2-oldprice m-text7 p-r-5 ">
                                        $@item.ProductPrice
                                    </span>

                                    <span class="block2-newprice m-text8 p-r-5">

                                        @{
                                            var sale = item.ProductPrice * (item.ProductSale / 100);
                                            var price = item.ProductPrice - sale;
                                            total += price;
                                        }

                                        $<span class="price-item">
                                            @Math.Round(price, 2)
                                        </span>
                                    </span>
                                }
                                else
                                {

                                    <span>&#x24;</span>
                                    <span class="price-item">
                                        @item.ProductPrice
                                    </span>
                                    total += item.ProductPrice;
                                }
                            </td>

                            <td class="column-4 tools"><i onclick="remove(this,@item.ProductId)" class="fa fa-trash-o"></i></td>
                        </tr>
                        }

                    </table>
                </div>
            </div>



            <!-- Total -->
            <div class="bo9 w-size18 p-l-40 p-r-40 p-t-30 p-b-38 m-t-30 m-r-0 m-l-auto p-lr-15-sm">
                <h5 class="m-text20 p-b-24">
                    Cart Totals
                </h5>

                <!--  -->
                <div class="flex-w flex-sb-m p-b-12">
                    <span class="s-text18 w-size19 w-full-sm">
                        Subtotal:
                    </span>

                    <span class="m-text21 w-size20 w-full-sm" >
                        $<span id="total">
                            @{
                                @Math.Round(total, 2)
                            }
                        </span>
                    </span>
                </div>

                <!--  -->
                <div class="flex-w flex-sb bo10 p-t-15 p-b-20">
                    <span class="s-text18 w-size19 w-full-sm">
                        Shipping:
                    </span>

                    <div class="w-size20 w-full-sm">
                        <p class="s-text8 p-b-23">
                            There are no shipping methods available. Please double check your address, or contact us if you need any help.
                        </p>

                        <span class="s-text19">
                            Calculate Shipping
                        </span>

                        <div class="rs2-select2 rs3-select2 rs4-select2 bo4 of-hidden w-size21 m-t-8 m-b-12">
                            <select class="selection-2" name="country">
                                <option>Select a country...</option>
                                <option>US</option>
                                <option>UK</option>
                                <option>Japan</option>
                            </select>
                        </div>

                        <div class="size13 bo4 m-b-12">
                            <input class="sizefull s-text7 p-l-15 p-r-15" type="text" name="state" placeholder="State /  country">
                        </div>

                        <div class="size13 bo4 m-b-22">
                            <input class="sizefull s-text7 p-l-15 p-r-15" type="text" name="postcode" placeholder="Postcode / Zip">
                        </div>

                        <div class="size14 trans-0-4 m-b-10">
                            <!-- Button -->
                            <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                                Update Totals
                            </button>
                        </div>
                    </div>
                </div>

                <!--  -->
                <div class="flex-w flex-sb-m p-t-26 p-b-30">
                    <span class="m-text22 w-size19 w-full-sm">
                        Total:
                    </span>

                    <span class="m-text21 w-size20 w-full-sm">
                        $39.00
                    </span>
                </div>

                <div class="size15 trans-0-4">
                    <!-- Button -->
                    <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                        Proceed to Checkout
                    </button>
                </div>
            </div>

        }
        else
        {
            <h1 class="text-center">NO ITEMS TO DISPLAY</h1>
        }
    </div>
</section>

@section scripts
{
    <script>
        function remove(td,id) {
            
                swal({
                    title: "Are you sure?",
                    text: "You want to remove from cart",
                    icon: "warning",
                    buttons: {
                        cancel: true,
                        confirm: "Remove"
                            
                    }
                }).then(function (isConfirm) {
                    if (isConfirm) {
                        
                      
                        $.ajax({
                            url: '/Order/Remove',
                            type: "POST",
                            data: {
                                id: id
                            },
                            error: function() {
                                swal("Failed", "Something went wrong", "error");
                            },
                            success: function() {
                                swal("Removed!", "Your item has been Removed.", "success");

                                var price = parseFloat($(td).parent().parent().find('.price-item').text());
                                var total = $('#total').text();
                                total -= price;
                                $('#total').text(total);

                                $(td).parent().parent().fadeOut(1000);
                            }
                        });


                    } else {
                        swal("Cancelled", "You cancel ", "error");
                    }
                });
                       
                //swal(nameProduct + " and id is " + Id, "is added to cart !", "success");
            
        }
    </script>
}

